(this["webpackJsonpflow-frontend"]=this["webpackJsonpflow-frontend"]||[]).push([[5],{106:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var c=n(18),a=n(39),i=(n(1),n(148)),o=n.n(i),r=n(184),d=n(183),s=n(2),l=(n(124),n(8)),u=function(t){var e=t.handleSave,n=t.hasPreviewButton,i=t.children,u=Object(a.a)(t,["handleSave","hasPreviewButton","children"]),b=Object(s.g)();return Object(l.jsxs)("div",Object(c.a)(Object(c.a)({className:"CardHeader"},u),{},{children:[Object(l.jsxs)("div",{className:"left-section",children:[i,Object(l.jsx)(d.a,{disableRipple:!0,children:Object(l.jsx)(o.a,{})})]}),Object(l.jsxs)("div",{className:"d-flex",children:[n&&Object(l.jsx)(r.a,{variant:"text",className:"btn-preview",onClick:function(){b.push({pathname:"/preview"})},children:"Go to Preview"}),e&&Object(l.jsx)(r.a,{variant:"contained",onClick:e,children:"Save"})]})]}))}},113:function(t,e,n){"use strict";n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return o})),n.d(e,"e",(function(){return r})),n.d(e,"c",(function(){return d}));var c=[{id:1,name:"New order placed"},{id:2,name:"New signup"},{id:3,name:"New subscriber"},{id:4,name:"New cancellation"}],a=[{id:1,name:"Amount > 100"},{id:2,name:"Amount < 100"},{id:3,name:"Product is Coffee"},{id:4,name:"Product is Tea"},{id:5,name:"Date > Today"},{id:6,name:"Date < Today"}],i=[{id:1,name:"Send email to Contact",type:"email",label:"Email address"},{id:2,name:"Call Contact",type:"tel",label:"Contact Number"},{id:3,name:"Add Tag to Contact",type:"tel",label:"Contact Number"},{id:4,name:"Remove Contact",type:"tel",label:"Contact Number"}],o=[{eventKey:"NewOrder",eventDisplay:"New order placed",fields:[{conditionKey:"ProductTitle",conditionDisplay:"Product Title",type:"string"},{conditionKey:"ProductAmount",conditionDisplay:"Product Amount",type:"int"}]},{eventKey:"NewSignup",eventDisplay:"New signup",fields:[{conditionKey:"Gender",conditionDisplay:"Customer Gender",type:"option",options:["Male","Female"]},{conditionKey:"DOB",conditionDisplay:"Birthday",type:"date"}]}],r=[{actionKey:"SendEmail",actionDisplay:"Send email to contact",fields:[{key:"emailAddress",placeHolder:"Email Address",type:"string"}]},{actionKey:"CallContact",actionDisplay:"Call contact",fields:[{key:"callContact",placeHolder:"Contact Number",type:"string"},{key:"callContactCountry",placeHolder:"Country",type:"selection",option:["Singapore","Malaysia"]}]}],d=[{name:"Equal",value:"=",type:"string"},{name:"Not equal",value:"!=",type:"string"},{name:"Contains",value:"contains",type:"string"},{name:"Not contains",value:"not contains",type:"string"},{name:"Greater than",value:">",type:"int"},{name:"Less than",value:"<",type:"int"},{name:"Greater and equal than",value:">=",type:"int"},{name:"Less and equal than",value:"<=",type:"int"},{name:"Equal",value:"=",type:"date"},{name:"Earlier than",value:"earlier than",type:"date"},{name:"Later than",value:"later than",type:"date"}]},124:function(t,e,n){},132:function(t,e,n){"use strict";var c=n(1),a=n.n(c),i=n(121),o=n(185),r=n(184),d=n(150),s=n.n(d),l=n(183),u=(n(133),n(8));e.a=Object(c.memo)((function(t){var e,n,c=t.id,d=t.data,b=t.isConnectable,j=Object(i.e)((function(t){return t.selectedElements}));return Object(u.jsxs)("div",{className:"ButtonSelectorNode ".concat(j&&j[0].id===c?"is-selected":""),onClick:function(){return d.focusNodeAction(c)},children:[Object(u.jsx)("div",{children:Object(u.jsx)(o.a,{variant:"body1",children:d.label})}),"event"===d.type&&(d.item?Object(u.jsx)(r.a,{variant:"contained",disabled:!0,className:"lbl-event",children:null===(e=d.item)||void 0===e?void 0:e.eventDisplay}):d.btnLabel&&Object(u.jsx)(r.a,{onClick:function(t){d.btnAction(c),t.stopPropagation()},variant:"contained",children:d.btnLabel})),("condition"===d.type||"choice"===d.type)&&(d.item?Object(u.jsx)(r.a,{variant:"contained",disabled:!0,className:"lbl-condition",children:Object.keys(d.item)[0].includes("Fn::")?Object.values(d.item)[0].map((function(t){return"".concat(t.conditionKey," ").concat(t.operator," ").concat(t.value.join(", "))})).join(" ".concat(Object.keys(d.item)[0].replace("Fn::","")," ")):"".concat(d.item.conditionKey," ").concat(d.item.operator," ").concat(d.item.value.join(", "))}):d.btnLabel&&Object(u.jsx)(r.a,{onClick:function(t){d.btnAction(c),t.stopPropagation()},variant:"contained",children:d.btnLabel})),d.type.includes("action")&&((null===(n=d.item)||void 0===n?void 0:n.length)?d.item.map((function(t,e){return Object(u.jsx)(a.a.Fragment,{children:Object(u.jsxs)("div",{className:"label-div",children:[Object(u.jsx)(r.a,{variant:"contained",onClick:function(t){d.handleSelectAction(c,e),t.stopPropagation()},className:"lbl-action",children:"Action: ".concat(t.actionKey,"\n                    ").concat(t.actionInputs.map((function(t){return"".concat(t.key," - ").concat(t.value)})).join(", "))}),Object(u.jsx)(l.a,{disableRipple:!0,onClick:function(t){d.handleDeleteAction(c,e),t.stopPropagation()},children:Object(u.jsx)(s.a,{})}),e!==d.item.length-1&&Object(u.jsx)(o.a,{variant:"h6",children:"AND"})]})},e)})):d.btnLabel&&Object(u.jsx)(r.a,{onClick:function(t){d.btnAction(c),t.stopPropagation()},variant:"contained",children:d.btnLabel})),"choice"===d.type&&Object(u.jsx)(o.a,{variant:"h6",className:"text-or",children:"OR"}),d.btnLabel2&&Object(u.jsx)(r.a,{onClick:function(t){d.btnAction2(c),t.stopPropagation()},variant:"contained",children:d.btnLabel2}),Object(u.jsx)(i.a,{type:"source",position:"bottom",style:{bottom:10,top:"auto",background:"#555"},isConnectable:b})]})}))},133:function(t,e,n){},165:function(t,e,n){},166:function(t,e,n){},195:function(t,e,n){"use strict";n.r(e);var c=n(40),a=n(134),i=n(18),o=n(110),r=n(1),d=n(121),s=n(184),l=n(185),u=n(189),b=n(41),j=n(106),p=n(39),f=n(120),O=n.n(f),m=n(127),y=n.n(m),h=n(128),v=n.n(h),g=(n(165),n(8)),x=function(t){var e=Object(r.useState)(!1),n=Object(o.a)(e,2),c=n[0],a=n[1],d=t.type,l=t.listItems,u=t.nodeId,b=t.selectedId,j=t.onFocusId,f=t.handleSelect,m=Object(p.a)(t,["type","listItems","nodeId","selectedId","onFocusId","handleSelect"]);return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("div",Object(i.a)(Object(i.a)({className:"CardBody ".concat(l.length>3?"has-show-more":""," ").concat(c?"show-all":"")},m),{},{children:("actions"===d||"conditions"===d?l.filter((function(t){var e;return!(null===(e=b[u])||void 0===e?void 0:e.includes(t.id))})):l.filter((function(t){return!b.includes(t.id)}))).map((function(t){return Object(g.jsx)(s.a,{onClick:function(){return f(t.id)},disableRipple:!0,variant:"text",className:"btn-card-item ".concat(j===t.id?"on-focus":""),startIcon:Object(g.jsx)(O.a,{}),children:t.name},t.id)}))})),l.length>3&&Object(g.jsx)("div",{className:"btn-show-more",children:Object(g.jsxs)(s.a,{onClick:function(){return a(!c)},variant:"text",disableRipple:!0,endIcon:c?Object(g.jsx)(y.a,{}):Object(g.jsx)(v.a,{}),children:["Show ",c?"less":"more"]})})]})},N=n(132),S=n(113),C=(n(166),{btnSelectorNode:N.a});e.default=function(){var t=Object(r.useState)("events"),e=Object(o.a)(t,2),n=e[0],p=e[1],f=Object(r.useState)("1"),O=Object(o.a)(f,2),m=O[0],y=O[1],h=Object(r.useState)([]),v=Object(o.a)(h,2),N=v[0],A=v[1],k=Object(r.useState)({}),w=Object(o.a)(k,2),I=w[0],D=w[1],L=Object(r.useState)({}),P=Object(o.a)(L,2),F=P[0],K=P[1],R=Object(r.useState)(null),E=Object(o.a)(R,2),T=E[0],B=E[1],q=[{event:{id:1,name:"New order placed"}},{conditions:[{id:1,name:"Amount > 100"}]},{"action-yes":[{id:2,label:"Call Contact",name:"Call Contact",type:"tel",value:"888"}]},{action:[{id:2,label:"Contact Number",name:"Call Contact",type:"tel",value:"999"}]}],G=Object(r.useState)(function(){var t=[],e=1,n={x:250,y:25};return q.forEach((function(c){switch(Object.keys(c)[0]){case"event":t.push({id:e.toString(),type:"btnSelectorNode",data:Object(i.a)({label:"When",type:"event",btnLabel:"Select event trigger",focusNodeAction:function(t){p("events"),y(t)},btnAction:function(t){p("events"),y(t)}},c),position:n},{id:"edges-".concat(e.toString(),"-").concat(e+1),source:e.toString(),target:(Number(e)+1).toString(),type:"smoothstep"});break;case"conditions":n={x:n.x,y:n.y+175},++e,t.push({id:e.toString(),type:"btnSelectorNode",data:Object(i.a)({label:"If...",type:"condition",btnLabel:"Add condition",focusNodeAction:function(t){p("conditions"),y(t)},btnAction:function(t){p("conditions"),y(t)},handleDeleteCondition:function(t,e){return X(t,e)}},c),position:n},{id:"edges-".concat(e.toString(),"-").concat(e+1),source:e.toString(),target:(Number(e)+1).toString(),type:"smoothstep",label:"yes"},{id:"edges-".concat(e.toString(),"-").concat(e+2),source:e.toString(),target:(Number(e)+2).toString(),type:"smoothstep",label:"no"});break;case"action-yes":n={x:n.x,y:n.y+400},++e,t.push({id:e.toString(),type:"btnSelectorNode",data:{label:"Then...",type:"action-yes",btnLabel:"Add action",focusNodeAction:function(t){p("actions"),y(t)},btnAction:function(t){p("actions"),y(t)},handleDeleteCondition:function(t,e){return X(t,e)},actions:c["action-yes"]},position:n});break;case"action":n={x:n.x+300,y:n.y},++e,t.push({id:e.toString(),type:"btnSelectorNode",data:{label:"Then...",type:"action",btnLabel:"Add action",focusNodeAction:function(t){p("actions"),y(t)},btnAction:function(t){p("actions"),y(t)},handleDeleteCondition:function(t,e){return X(t,e)},actions:c.action},position:n})}})),t}()),H=Object(o.a)(G,2),M=H[0],W=H[1],J=Object(r.useRef)();J.current=M;var z=Object(r.useRef)();z.current=m;var Q=Object(r.useRef)();Q.current=I;var U=Object(r.useRef)();U.current=F;var V=function t(e,n){return{label:"Next Step",type:"choice",btnLabel:"Add condition",focusNodeAction:function(t){p(null),y(t)},btnAction:function(c){var i;p("conditions"),y(c);var o=Object.assign([],J.current);(i=o=o.filter((function(t){return t.id!==e&&t.id!=="edges-".concat((Number(e)-1).toString(),"-").concat(e)}))).push.apply(i,[{id:e,type:"btnSelectorNode",data:{label:"If...",type:"condition",btnLabel:"Add condition",focusNodeAction:function(t){p("conditions"),y(t)},btnAction:function(t){p("conditions"),y(t)},handleDeleteCondition:function(t,e){return X(t,e)}},position:n},{id:(Number(e)+1).toString(),type:"btnSelectorNode",data:{label:"Then...",type:"action-yes",btnLabel:"Add action",focusNodeAction:function(t){p("actions"),y(t)},btnAction:function(t){p("actions"),y(t)},handleDeleteAction:function(t,e){return Y(t,e)}},position:{x:n.x,y:n.y+400}},{id:(Number(e)+2).toString(),type:"btnSelectorNode",data:t((Number(e)+2).toString(),{x:n.x+300,y:n.y+150}),position:{x:n.x+300,y:n.y+150}}].concat(Object(a.a)("2"===e?[{id:"edges-".concat((Number(e)-1).toString(),"-").concat(e),source:(Number(e)-1).toString(),target:e,type:"smoothstep"}]:[]),[{id:"edges-".concat(e,"-").concat((Number(e)+1).toString()),source:e,target:(Number(e)+1).toString(),type:"smoothstep",label:"yes"},{id:"edges-".concat(e,"-").concat((Number(e)+2).toString()),source:e,target:(Number(e)+2).toString(),type:"smoothstep",label:"no"}])),W(o)},btnLabel2:"Add Action",btnAction2:function(t){var c;p("actions"),y(t);var i=Object.assign([],J.current);(c=i=i.filter((function(t){return t.id!==e&&t.id!=="edges-".concat((Number(e)-1).toString(),"-").concat(e)}))).push.apply(c,[{id:e,type:"btnSelectorNode",data:{label:"Then...",type:"action",btnLabel:"Add action",focusNodeAction:function(t){p("actions"),y(t)},btnAction:function(t){p("actions"),y(t)},handleDeleteAction:function(t,e){return Y(t,e)}},position:n}].concat(Object(a.a)("2"===e?[{id:"edges-".concat((Number(e)-1).toString(),"-").concat(e),source:(Number(e)-1).toString(),target:e,type:"smoothstep"}]:[]))),W(i)},handleDeleteCondition:function(t,e){return X(t,e)}}},X=function(t,e){var n,a=Object.assign([],J.current),o=a.findIndex((function(e){return e.id===t}));a[o]=Object(i.a)(Object(i.a)({},a[o]),{},{data:Object(i.a)(Object(i.a)({},a[o].data),{},{conditions:((null===(n=a[o].data)||void 0===n?void 0:n.conditions)||[]).filter((function(t){return t.id!==e}))})}),D(Object(i.a)(Object(i.a)({},Q.current),{},Object(c.a)({},z.current,(Q.current[z.current]||[]).filter((function(t){return t!==e}))))),W(a)},Y=function(t,e){var n,a=Object.assign([],J.current),o=a.findIndex((function(e){return e.id===t}));a[o]=Object(i.a)(Object(i.a)({},a[o]),{},{data:Object(i.a)(Object(i.a)({},a[o].data),{},{actions:((null===(n=a[o].data)||void 0===n?void 0:n.actions)||[]).filter((function(t){return t.id!==e}))})}),K(Object(i.a)(Object(i.a)({},U.current),{},Object(c.a)({},z.current,(U.current[z.current]||[]).filter((function(t){return t!==e}))))),W(a)};return Object(g.jsxs)(b.a,{fullHeight:!0,color:"PreviewPage grey100",children:[n&&Object(g.jsxs)("div",{className:"drawer",children:["events"===n&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(j.a,{children:Object(g.jsx)(l.a,{variant:"h3",children:"Events"})}),Object(g.jsx)(x,{type:"events",nodeId:m,listItems:S.d,selectedId:N,handleSelect:function(t){A([t]);var e=Object.assign([],M);e[0]={id:"1",type:"btnSelectorNode",data:{label:"When",type:"event",event:S.d.find((function(e){return e.id===t})),focusNodeAction:function(t){p("events"),y(t)},btnAction:function(t){p("events"),y(t)}},position:{x:250,y:25}},1===e.length&&e.push({id:"2",type:"btnSelectorNode",data:V("2",{x:250,y:200}),position:{x:250,y:200}},{id:"edges-1-2",source:"1",target:"2",type:"smoothstep"}),p(null),W(e)}})]}),"conditions"===n&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(j.a,{children:Object(g.jsx)(l.a,{variant:"h3",children:"Conditions"})}),Object(g.jsx)(x,{type:"conditions",nodeId:m,listItems:S.b,selectedId:I,handleSelect:function(t){var e;D((function(e){return Object(i.a)(Object(i.a)({},e),{},Object(c.a)({},m,[].concat(Object(a.a)(I[m]||[]),[t])))}));var n=Object.assign([],M),o=n.findIndex((function(t){return t.id===m}));n[o]=Object(i.a)(Object(i.a)({},n[o]),{},{data:Object(i.a)(Object(i.a)({},n[o].data),{},{conditions:[].concat(Object(a.a)((null===(e=n[o].data)||void 0===e?void 0:e.conditions)||[]),[S.b.find((function(e){return e.id===t}))])})}),W(n)}})]}),"actions"===n&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(j.a,{children:Object(g.jsx)(l.a,{variant:"h3",children:"Actions"})}),Object(g.jsx)(x,{type:"actions",nodeId:m,listItems:S.a,selectedId:F,onFocusId:null===T||void 0===T?void 0:T.id,handleSelect:function(t){B(S.a.find((function(e){return e.id===t})))}}),T&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(j.a,{children:Object(g.jsx)(l.a,{variant:"h3",children:"Action Details"})}),Object(g.jsxs)("div",{className:"card-body",children:[Object(g.jsx)(u.a,{fullWidth:!0,margin:"dense",onChange:function(t){return B((function(e){return Object(i.a)(Object(i.a)({},e),{},{value:t.target.value})}))},type:T.type,value:T.value||"",label:T.label}),Object(g.jsx)(s.a,{variant:"text",disableRipple:!0,onClick:function(){var t;K((function(t){return Object(i.a)(Object(i.a)({},t),{},Object(c.a)({},m,[].concat(Object(a.a)(F[m]||[]),[T.id])))}));var e=Object.assign([],M),n=e.findIndex((function(t){return t.id===m}));e[n]=Object(i.a)(Object(i.a)({},e[n]),{},{data:Object(i.a)(Object(i.a)({},e[n].data),{},{actions:[].concat(Object(a.a)((null===(t=e[n].data)||void 0===t?void 0:t.actions)||[]),[T])})}),W(e)},children:"Add"})]})]})]})]}),Object(g.jsxs)("div",{className:"home-section",children:[Object(g.jsx)(j.a,{handleSave:function(){var t=M.filter((function(t){return"btnSelectorNode"===t.type})),e=[];t.forEach((function(t){switch(t.data.type){case"event":e.push({event:t.data.event});break;case"condition":e.push({condition:t.data.conditions});break;case"action-yes":case"action":e.push(Object(c.a)({},t.data.type,Object(a.a)(t.data.actions||[])))}})),console.log("output",e)},children:Object(g.jsx)(l.a,{variant:"h3",children:"Map your automation"})}),Object(g.jsx)("div",{className:"flow-body",children:Object(g.jsx)(d.c,{elementsSelectable:!0,elements:M,onElementsRemove:function(t){return W((function(e){return Object(d.d)(t,e)}))},onConnect:function(t){return W((function(e){return Object(d.b)(t,e)}))},nodeTypes:C,deleteKeyCode:46,onSelectionChange:function(t){t||p(null)}})})]})]})}}}]);
//# sourceMappingURL=5.5c55f84c.chunk.js.map