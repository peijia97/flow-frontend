(this["webpackJsonpflow-frontend"]=this["webpackJsonpflow-frontend"]||[]).push([[4],{175:function(e,t,n){},177:function(e,t,n){},178:function(e,t,n){},181:function(e,t,n){},182:function(e,t,n){},184:function(e,t,n){},199:function(e,t,n){"use strict";n.r(t);var i=n(32),a=n(31),c=n(57),o=n(166),l=n(0),r=n.n(l),d=n(167),s=n(145),u=n(147),b=n(176),j=n.n(b),v=n(146),f=(n(175),n(7)),O=function(e){var t=e.handleSave,n=e.hasPreviewButton,i=e.handlePreview,o=e.children,l=Object(c.a)(e,["handleSave","hasPreviewButton","handlePreview","children"]);return Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"CardHeader"},l),{},{children:[Object(f.jsxs)("div",{className:"left-section",children:[o,Object(f.jsx)(v.a,{disableRipple:!0,children:Object(f.jsx)(j.a,{})})]}),Object(f.jsxs)("div",{className:"d-flex",children:[n&&Object(f.jsx)(u.a,{variant:"text",className:"btn-preview",onClick:i,children:"View Preset Flow"}),t&&Object(f.jsx)(u.a,{variant:"contained",onClick:t,children:"Save"})]})]}))},y=n(154),h=n.n(y),p=n(163),m=n.n(p),g=n(164),x=n.n(g),S=[{eventKey:"NewOrder",eventDisplay:"New order placed",fields:[{conditionKey:"ProductTitle",conditionDisplay:"Product Title",type:"string"},{conditionKey:"ProductAmount",conditionDisplay:"Product Amount",type:"int"}]},{eventKey:"NewSignup",eventDisplay:"New signup",fields:[{conditionKey:"Gender",conditionDisplay:"Customer Gender",type:"option",options:["Male","Female"]},{conditionKey:"DOB",conditionDisplay:"Birthday",type:"date"}]}],N=[{actionKey:"SendEmail",actionDisplay:"Send email to contact",fields:[{key:"emailAddress",placeHolder:"Email Address",type:"string"}]},{actionKey:"CallContact",actionDisplay:"Call contact",fields:[{key:"callContact",placeHolder:"Contact Number",type:"string"},{key:"callContactCountry",placeHolder:"Country",type:"selection",option:["Singapore","Malaysia"]}]}],K=[{name:"Equal",value:"=",type:"string"},{name:"Not equal",value:"!=",type:"string"},{name:"Contains",value:"contains",type:"string"},{name:"Not contains",value:"not contains",type:"string"},{name:"Greater than",value:">",type:"int"},{name:"Less than",value:"<",type:"int"},{name:"Greater and equal than",value:">=",type:"int"},{name:"Less and equal than",value:"<=",type:"int"},{name:"Equal",value:"=",type:"date"},{name:"Earlier than",value:"earlier than",type:"date"},{name:"Later than",value:"later than",type:"date"}],C="NewOrder",k=[{"Fn::If":[[{"Fn::And":[{conditionKey:"ProductTitle",value:["coke","pepsi"],operator:"contains"},{conditionKey:"ProductAmount",value:["30"],operator:">="}]}],[{"Fn::If":[[{conditionKey:"ProductTitle",value:["coke"],operator:"="}],[{actionKey:"CallContact",actionInputs:[{key:"callContact",value:"999"},{key:"callContactCountry",value:"Singapore"}]}],[{actionKey:"SendEmail",actionInputs:[{key:"emailAddress",value:"simon@gmail.com"}]}]]}],[{actionKey:"CallContact",actionInputs:[{key:"callContact",value:"0123456789"},{key:"callContactCountry",value:"Malaysia"}]},{actionKey:"SendEmail",actionInputs:[{key:"emailAddress",value:"hello@gmail.com"}]}]]}],A=(n(177),function(e){var t=e.handleSelect,n=e.selectedEventKey,o=Object(c.a)(e,["handleSelect","selectedEventKey"]),r=Object(l.useState)(!1),d=Object(i.a)(r,2),b=d[0],j=d[1];return Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"Events"},o),{},{children:[Object(f.jsx)(O,{children:Object(f.jsx)(s.a,{variant:"h3",children:"Events"})}),Object(f.jsx)("div",Object(a.a)(Object(a.a)({className:"content-body ".concat(S.length>3?"has-show-more":""," ").concat(b?"show-all":"")},o),{},{children:S.map((function(e){return Object(f.jsx)(u.a,{onClick:function(){return t(e)},disableRipple:!0,variant:"text",className:"btn-card-item ".concat(n===e.eventKey?"on-focus":""),startIcon:Object(f.jsx)(h.a,{}),children:e.eventDisplay},e.eventKey)}))})),S.length>3&&Object(f.jsx)("div",{className:"btn-show-more",children:Object(f.jsxs)(u.a,{onClick:function(){return j(!b)},variant:"text",disableRipple:!0,endIcon:b?Object(f.jsx)(m.a,{}):Object(f.jsx)(x.a,{}),children:["Show ",b?"less":"more"]})})]}))}),w=n(63),I=n(196),P=n(201),F=n(202),R=n(193),B=n(197),D=n(198),E=n(180),L=n.n(E),W=n(58),H=(n(178),function(e){var t=e.selectedEventKey,n=e.selectedConditionObj,d=e.handleSelect,b=Object(c.a)(e,["selectedEventKey","selectedConditionObj","handleSelect"]);Object(l.useEffect)((function(){var e,t;k((null===(e=Object.keys(n)[0])||void 0===e?void 0:e.includes("Fn::"))?Object.values(n)[0]:[{conditionKey:n.conditionKey||"",value:n.value||[],operator:n.operator||""}]),g((null===(t=Object.keys(n)[0])||void 0===t?void 0:t.includes("Fn::"))?Object.keys(n)[0]:"")}),[n]);var j={conditionKey:"",value:[],operator:""},v=S.find((function(e){return e.eventKey===t})).fields,y=Object(l.useState)(""),p=Object(i.a)(y,2),m=p[0],g=p[1],x=Object(l.useState)([{conditionKey:"",value:[],operator:""}]),N=Object(i.a)(x,2),C=N[0],k=N[1],A=function(e,t,n){var i=Object.assign([],C);"value"===n?i[t].value=e.split(","):i[t][n]=e,k(i)};return Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"Conditions"},b),{},{children:[Object(f.jsx)(O,{children:Object(f.jsx)(s.a,{variant:"h3",children:"Conditions"})}),Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"content-body"},b),{},{children:[C.length>1&&Object(f.jsxs)(R.a,{className:"mb-1-5",children:[Object(f.jsx)(P.a,{id:"label-must-meet",children:"All conditions must meet"}),Object(f.jsxs)(D.a,{labelId:"label-must-meet",id:"must-meet",value:m,onChange:function(e){return g(e.target.value)},children:[Object(f.jsx)(F.a,{value:"Fn::And",children:"AND"}),Object(f.jsx)(F.a,{value:"Fn::Or",children:"OR"})]})]}),C.map((function(e,t){var n,i;return Object(f.jsxs)(r.a.Fragment,{children:[0!==t&&Object(f.jsx)(u.a,{className:"btn-clear",variant:"text",startIcon:Object(f.jsx)(L.a,{}),disableRipple:!0,onClick:function(){return function(e){2===C.length&&g("");var t=Object.assign([],C);t.splice(e,1),k(t)}(t)},children:"Remove"}),Object(f.jsxs)(R.a,{children:[Object(f.jsxs)(P.a,{id:"label-condition-".concat(t),children:["Condition ",t+1]}),Object(f.jsx)(D.a,{labelId:"label-condition-".concat(t),id:"condition-".concat(t),value:e.conditionKey||"",onChange:function(e){return A(e.target.value,t,"conditionKey")},children:v.map((function(e){return Object(f.jsx)(F.a,{value:e.conditionKey,children:e.conditionDisplay},e.conditionKey)}))})]}),Object(f.jsxs)(R.a,{children:[Object(f.jsxs)(P.a,{id:"label-operator-".concat(t),children:["Operator ",t+1]}),Object(f.jsx)(D.a,{labelId:"label-operator-".concat(t),id:"operator-".concat(t),value:e.operator||"",onChange:function(e){return A(e.target.value,t,"operator")},children:"option"===(null===(n=v.find((function(t){return t.conditionKey===e.conditionKey})))||void 0===n?void 0:n.type)?v.find((function(t){return t.conditionKey===e.conditionKey})).options.map((function(e){return Object(f.jsx)(F.a,{value:e,children:e},e)})):null===(i=K.filter((function(t){var n;return t.type===(null===(n=v.find((function(t){return t.conditionKey===e.conditionKey})))||void 0===n?void 0:n.type)})))||void 0===i?void 0:i.map((function(e){return Object(f.jsx)(F.a,{value:e.value,children:e.name},e.value)}))})]}),Object(f.jsxs)(R.a,{children:[Object(f.jsx)(I.a,{fullWidth:!0,margin:"dense",onChange:function(e){return A(e.target.value,t,"value")},type:"text",value:e.value.join(",")||"",label:"Value ".concat(t+1)}),Object(f.jsx)(B.a,{children:"Please separate multiple values by comma"})]}),C.length-1!==t&&Object(f.jsx)(s.a,{variant:"h6",className:"must-meet-separator",children:"Fn::And"===m?"AND":"OR"})]},t)})),Object(f.jsx)(u.a,{variant:"text",startIcon:Object(f.jsx)(h.a,{}),disableRipple:!0,className:"btn-add",onClick:function(){m||g("Fn::And"),k([].concat(Object(o.a)(C),[j]))},children:"Add Condition"}),Object(f.jsx)(u.a,{variant:"contained",disableRipple:!0,onClick:function(){if(C.find((function(e){return!e.conditionKey||!e.operator||e.value.filter((function(e){return!e})).length})))Object(W.a)({title:"Warning",subtitle:"Please complete the condition fields before saving",btnLabel:"OK"});else{for(var e=Object.assign([],C),t=function(){var t=e[0],n=e.filter((function(e){return e.conditionKey===t.conditionKey}));e=e.filter((function(e){return n.includes(e.conditionKey)}))};e.length>0;)t();console.log(C);var n=m?Object(w.a)({},m,C):C[0];d(n)}},children:"Save Condition"})]}))]}))}),T=(n(181),function(e){var t=e.handleSelect,n=(e.handleAddAction,e.actionsArr,e.selectedActionObj),o=e.unavailableActionKeys,r=Object(c.a)(e,["handleSelect","handleAddAction","actionsArr","selectedActionObj","unavailableActionKeys"]),d=Object(l.useState)({}),b=Object(i.a)(d,2),j=b[0],v=b[1];Object(l.useEffect)((function(){Object.keys(n).length?K(y(n)):(K({}),v({}))}),[n]);var y=function(e){return v(e.actionInputs.reduce((function(e,t){return e[t.key]=t.value,e}),{})),N.find((function(t){return t.actionKey===e.actionKey}))},p=Object(l.useState)({}),g=Object(i.a)(p,2),S=g[0],K=g[1],C=Object(l.useState)(!1),k=Object(i.a)(C,2),A=k[0],w=k[1],B=function(e,t){if("callContact"!==t.key||/^[0-9]*$/.test(e.target.value)){var n=Object.assign({},j);n[t.key]=e.target.value,v(n)}};return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"Actions"},r),{},{children:[Object(f.jsx)(O,{children:Object(f.jsx)(s.a,{variant:"h3",children:"Actions"})}),Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"content-body ".concat(N.length>3?"has-show-more":""," ").concat(A?"show-all":"")},r),{},{children:[N.filter((function(e){return!o.includes(e.actionKey)})).map((function(e){return Object(f.jsx)(u.a,{onClick:function(){K(e)},disableRipple:!0,variant:"text",className:"btn-card-item ".concat((null===S||void 0===S?void 0:S.actionKey)===e.actionKey?"on-focus":""),startIcon:Object(f.jsx)(h.a,{}),children:e.actionDisplay},e.actionKey)})),!N.filter((function(e){return!o.includes(e.actionKey)})).length&&Object(f.jsx)(s.a,{variant:"body1",className:"label-no-more",children:"No action available"})]})),N.length>3&&Object(f.jsx)("div",{className:"btn-show-more",children:Object(f.jsxs)(u.a,{onClick:function(){return w(!A)},variant:"text",disableRipple:!0,endIcon:A?Object(f.jsx)(m.a,{}):Object(f.jsx)(x.a,{}),children:["Show ",A?"less":"more"]})})]})),Object.keys(S).length>0&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(O,{children:Object(f.jsx)(s.a,{variant:"h3",children:"Action Details"})}),Object(f.jsxs)("div",{className:"card-body",children:[S.fields.map((function(e){return"selection"===e.type?Object(f.jsxs)(R.a,{children:[Object(f.jsx)(P.a,{id:"label-".concat(e.key),children:e.placeHolder}),Object(f.jsx)(D.a,{labelId:"label-".concat(e.key),id:e.key,value:j[e.key]||"",onChange:function(t){return B(t,e)},children:e.option.map((function(e){return Object(f.jsx)(F.a,{value:e,children:e},e)}))})]},e.key):Object(f.jsx)(I.a,{fullWidth:!0,margin:"dense",onChange:function(t){return B(t,e)},type:"text",value:j[e.key]||"",label:e.placeHolder,placeholder:e.placeHolder},e.key)})),Object(f.jsx)(u.a,{variant:"contained",className:"mt-1",disableRipple:!0,onClick:function(){if(S.fields.length!==Object.keys(j).length||Object.values(j).filter((function(e){return!e})).length)Object(W.a)({title:"Warning",subtitle:"Please complete the action fields before saving",btnLabel:"OK"});else{var e={actionKey:S.actionKey,actionInputs:Object.entries(j).map((function(e){return{key:e[0],value:e[1]}}))};t(e,Object.keys(n).length?"update":"add")}},children:Object.keys(n).length?"Update":"Add"})]})]})]})}),q=n(66),G=n(183),M=n.n(G),J=(n(182),Object(l.memo)((function(e){var t,n,i=e.id,a=e.data,c=e.isConnectable,o=Object(d.e)((function(e){return e.selectedElements}));return Object(f.jsxs)("div",{className:"ButtonSelectorNode ".concat(o&&o[0].id===i?"is-selected":""),onClick:function(){return a.focusNodeAction(i)},children:[Object(f.jsx)(s.a,{variant:"body1",className:"node-label",children:a.label}),"event"===a.type&&(a.item?Object(f.jsx)(u.a,{variant:"text",disabled:!0,className:"lbl-event",children:null===(t=a.item)||void 0===t?void 0:t.eventDisplay}):a.btnLabel&&Object(f.jsx)(u.a,{onClick:function(e){a.btnAction(i),e.stopPropagation()},variant:"text",children:a.btnLabel})),("condition"===a.type||"choice"===a.type)&&Object(f.jsxs)(f.Fragment,{children:["condition"===a.type&&Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(v.a,{disableRipple:!0,className:"btn-delete",onClick:function(e){a.handleDeleteCondition(i),e.stopPropagation()},children:Object(f.jsx)(M.a,{})})}),a.item?Object(f.jsx)(u.a,{variant:"text",disabled:!0,className:"lbl-condition",children:Object.keys(a.item)[0].includes("Fn::")?Object.values(a.item)[0].map((function(e){return"".concat(e.conditionKey," ").concat(e.operator," ").concat(e.value.join(", "))})).join(" ".concat(Object.keys(a.item)[0].replace("Fn::","")," ")):"".concat(a.item.conditionKey," ").concat(a.item.operator," ").concat(a.item.value.join(", "))}):a.btnLabel&&Object(f.jsx)(u.a,{onClick:function(e){a.btnAction(i),e.stopPropagation()},variant:"text",children:a.btnLabel})]}),"action"===a.type&&((null===(n=a.item)||void 0===n?void 0:n.length)?Object(f.jsxs)(f.Fragment,{children:[a.item.map((function(e,t){return Object(f.jsx)(r.a.Fragment,{children:Object(f.jsxs)("div",{className:"label-div",children:[Object(f.jsx)(u.a,{variant:"text",onClick:function(e){a.handleSelectAction(i,t),e.stopPropagation()},className:"lbl-action",children:"Action: ".concat(e.actionKey,"\n                    ").concat(e.actionInputs.map((function(e){return"".concat(e.key," - ").concat(e.value)})).join(", "))}),Object(f.jsx)(v.a,{disableRipple:!0,onClick:function(n){a.handleDeleteAction(i,t,e.actionKey),n.stopPropagation()},children:Object(f.jsx)(M.a,{})}),t!==a.item.length-1&&Object(f.jsx)(s.a,{variant:"h6",children:"AND"})]})},t)})),Object(f.jsx)(u.a,{onClick:function(e){a.btnAction(i),e.stopPropagation()},variant:"text",children:"Add Action"})]}):a.btnLabel&&Object(f.jsx)(u.a,{onClick:function(e){a.btnAction(i),e.stopPropagation()},variant:"text",children:a.btnLabel})),"choice"===a.type&&Object(f.jsx)(s.a,{variant:"h6",className:"text-or",children:"OR"}),a.btnLabel2&&Object(f.jsx)(u.a,{onClick:function(e){a.btnAction2(i),e.stopPropagation()},variant:"text",children:a.btnLabel2}),Object(f.jsx)(d.a,{type:"source",position:"bottom",style:{bottom:10,top:"auto",background:"transparent"},isConnectable:c})]})}))),V=(n(184),{btnSelectorNode:J});t.default=function(){var e,t,n,r,u,b,j,v,y,h;Object(l.useEffect)((function(){window.innerWidth<768&&Object(W.a)({title:"Warning",subtitle:"Device must be larger than 768px x 1024px to support flow",persistent:!0})}),[]);var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:250,y:50};return{id:t.toString(),position:n,type:"btnSelectorNode",data:{item:e,type:"event",label:"When...",btnLabel:"Select Event Trigger",focusNodeAction:function(e){P("events"),D(e)},btnAction:function(e){P("events"),D(e)}}}},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:250,y:50};return{id:t.toString(),position:n,type:"btnSelectorNode",data:{item:e,type:"condition",label:"If...",btnLabel:"Add condition",focusNodeAction:function(e){P("conditions"),D(e)},handleSwapConditionArrows:function(e){return se(e)},handleDeleteCondition:function(e){return de(e)},btnAction:function(e){P("conditions"),D(e)}}}},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:250,y:50};return{id:t.toString(),position:n,type:"btnSelectorNode",data:{item:e,type:"action",label:"Then...",btnLabel:"Add action",focusNodeAction:function(e){P(null),M(null),D(e)},btnAction:function(e){P("actions"),M(null),D(e)},handleSelectAction:function(e,t){P("actions"),D(e),le(t)},handleDeleteAction:function(e,t,n){z(ce.current.filter((function(e){return e!==n}))),D(e),re(e,t)}}}},x=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:250,y:50};return{id:t.toString(),position:n,type:"btnSelectorNode",data:{type:"choice",label:"Next Step",btnLabel:"Add condition",btnLabel2:"Add action",focusNodeAction:function(e){P(null),D(e)},btnAction:function(i){var a;P("conditions"),Z(oe.current+1),D(i);var c=Object.assign([],ie.current);(a=c=c.filter((function(e){return e.id!==t&&e.id!=="edges-".concat((Number(t)-1).toString(),"-").concat(t)}))).push.apply(a,[m(null,t,n),g(null,Number(t)+1,{x:n.x-250,y:n.y+150}),oe.current+1===3?g(null,Number(t)+2,{x:n.x+300,y:n.y+150}):e((Number(t)+2).toString(),{x:n.x+300,y:n.y+150})].concat(Object(o.a)("2"===t?[N({source:(Number(t)-1).toString(),target:t})]:[]),[N({source:t,target:(Number(t)+1).toString(),label:"yes",labelBgPadding:[8,4],labelBgBorderRadius:13,labelStyle:{fill:"#3b8dd6",fontWeight:700},labelBgStyle:{fill:"#f1f7fb"}}),N({source:t,target:(Number(t)+2).toString(),label:"no",labelBgPadding:[8,4],labelBgBorderRadius:13,labelStyle:{fill:"#4a5568",fontWeight:700},labelBgStyle:{fill:"#ececec"}})])),ne(c)},btnAction2:function(e){var i;P("actions"),D(e);var a=Object.assign([],ie.current);(i=a=a.filter((function(e){return e.id!==t&&e.id!=="edges-".concat((Number(t)-1).toString(),"-").concat(t)}))).push.apply(i,[g(null,t,n)].concat(Object(o.a)("2"===t?[N({source:(Number(t)-1).toString(),target:t})]:[]))),ne(a)}}}},N=function(e){var t=e.source,n=e.target,i=Object(c.a)(e,["source","target"]);return Object(a.a)({id:"edges-".concat(t,"-").concat(n),source:t.toString(),target:n.toString(),type:"default"},i)},K=Object(l.useState)("events"),w=Object(i.a)(K,2),I=w[0],P=w[1],F=Object(l.useState)("1"),R=Object(i.a)(F,2),B=R[0],D=R[1],E=Object(l.useState)(null),L=Object(i.a)(E,2),G=L[0],M=L[1],J=Object(l.useState)([]),U=Object(i.a)(J,2),$=U[0],z=U[1],Q=Object(l.useState)(0),X=Object(i.a)(Q,2),Y=X[0],Z=X[1],_=Object(l.useState)([p()]),ee=Object(i.a)(_,2),te=ee[0],ne=ee[1],ie=Object(l.useRef)();ie.current=te;var ae=Object(l.useRef)();ae.current=B;var ce=Object(l.useRef)();ce.current=$;var oe=Object(l.useRef)();oe.current=Y;var le=function(e){M(e)},re=function(e,t){var n,i,c,o=Object.assign([],ie.current),l=o.findIndex((function(t){return t.id===e}));o[l]=Object(a.a)(Object(a.a)({},o[l]),{},{data:Object(a.a)(Object(a.a)({},null===(n=o[l])||void 0===n?void 0:n.data),{},{item:((null===(i=o[l])||void 0===i||null===(c=i.data)||void 0===c?void 0:c.item)||[]).filter((function(e,n){return n!==t}))})}),ne(o),P(null)},de=function(e){P(null)},se=function(e){var t=Object.assign([],ie.current),n=t.findIndex((function(t){return t.source===e&&"yes"===t.label})),i=t.findIndex((function(t){return t.source===e&&"no"===t.label}));t[n].label="yes"===t[n].label?"no":"yes",t[i].label="yes"===t[i].label?"no":"yes",ne(t)},ue=function e(t,n){var i,a,c,o,l,r={"Fn::If":[(null===(i=t.find((function(e){return e.id===n})).data)||void 0===i?void 0:i.item)?[null===(a=t.find((function(e){return e.id===n})).data)||void 0===a?void 0:a.item]:[]]},d=(t=t.filter((function(e){return e.target!==n&&e.id!==n}))).find((function(e){return e.source===n&&"yes"===e.label})).target;"condition"===(null===(c=t.find((function(e){return e.id===d})).data)||void 0===c?void 0:c.type)?r["Fn::If"].push([e(t,n)]):r["Fn::If"].push((null===(l=t.find((function(e){return e.id===d})).data)||void 0===l?void 0:l.item)||[]);var s,u=(t=t.filter((function(e){return e.target!==d&&e.id!==d}))).find((function(e){return e.source===n&&"no"===e.label})).target;"condition"===(null===(o=t.find((function(e){return e.id===u})).data)||void 0===o?void 0:o.type)?r["Fn::If"].push([e(t,u)]):r["Fn::If"].push((null===(s=t.find((function(e){return e.id===u})).data)||void 0===s?void 0:s.item)||[]);return t=t.filter((function(e){return e.target!==u&&e.id!==u})),r},be=function e(t,n,i){return[m(Object.values(t[0])[0],n,i),g(t[2],n+1,{x:i.x-250,y:i.y+150})].concat(Object(o.a)(Object.keys(t[1][0])[0].includes("Fn::")?e(Object.values(t[1][0])[0],n+2,{x:i.x+300,y:i.y+150}):[g(t[1],n+2,{x:i.x+300,y:i.y+150})]),[N({source:n,target:Number(n)+1,label:"yes",labelBgPadding:[8,4],labelBgBorderRadius:13,labelStyle:{fill:"#3b8dd6",fontWeight:700},labelBgStyle:{fill:"#f1f7fb"}}),N({source:n,target:Number(n)+2,label:"no",labelBgPadding:[8,4],labelBgBorderRadius:13,labelStyle:{fill:"#4a5568",fontWeight:700},labelBgStyle:{fill:"#ececec"}})])};return Object(f.jsxs)(q.a,{fullHeight:!0,color:"HomePage grey100",children:[I&&Object(f.jsxs)("div",{className:"drawer",children:["events"===I&&Object(f.jsx)(A,{selectedEventKey:null===(e=te[0].data)||void 0===e||null===(t=e.item)||void 0===t?void 0:t.eventKey,handleSelect:function(e){var t=Object.assign([],ie.current);t[0]=p(e),1===t.length&&t.push(x("2",{x:250,y:180}),N({source:"1",target:"2"})),P(null),ne(t)}}),"conditions"===I&&Object(f.jsx)(H,{selectedEventKey:null===(n=te[0].data)||void 0===n||null===(r=n.item)||void 0===r?void 0:r.eventKey,selectedConditionObj:(null===(u=ie.current.find((function(e){return e.id===ae.current})))||void 0===u||null===(b=u.data)||void 0===b?void 0:b.item)||{},handleSelect:function(e){var t,n=Object.assign([],ie.current),i=n.findIndex((function(e){return e.id===ae.current}));n[i]=Object(a.a)(Object(a.a)({},n[i]),{},{data:Object(a.a)(Object(a.a)({},null===(t=n[i])||void 0===t?void 0:t.data),{},{item:e})}),ne(n)}}),"actions"===I&&Object(f.jsx)(T,{actionsArr:(null===(j=ie.current.find((function(e){return e.id===ae.current})))||void 0===j||null===(v=j.data)||void 0===v?void 0:v.item)||[],selectedActionObj:((null===(y=ie.current.find((function(e){return e.id===ae.current})))||void 0===y||null===(h=y.data)||void 0===h?void 0:h.item)||[])[G]||{},unavailableActionKeys:$,handleSelect:function(e,t){var n,i,c,l,r,d,s,u=Object.assign([],ie.current),b=u.findIndex((function(e){return e.id===ae.current}));u[b]=Object(a.a)(Object(a.a)({},u[b]),{},{data:Object(a.a)(Object(a.a)({},null===(n=u[b])||void 0===n?void 0:n.data),{},{item:"update"===t?[].concat(Object(o.a)(null===(i=u[b])||void 0===i||null===(c=i.data)||void 0===c?void 0:c.item.slice(0,G)),[e],Object(o.a)(null===(l=u[b])||void 0===l||null===(r=l.data)||void 0===r?void 0:r.item.slice(G+1))):[].concat(Object(o.a)((null===(d=u[b])||void 0===d||null===(s=d.data)||void 0===s?void 0:s.item)||[]),[e])})}),console.log(B),z([].concat(Object(o.a)($),[e.actionKey])),ne(u)}})]}),Object(f.jsxs)("div",{className:"home-section",children:[Object(f.jsx)(O,{hasPreviewButton:!0,handlePreview:function(){var e=1,t={x:250,y:200},n=[],i=Object.assign([],k[0]["Fn::If"]);n.push(p(S.find((function(e){return e.eventKey===C}))));for(var a=0;a<3;)e+=1,Object.keys(i[a]).includes("Fn::")||Object.keys(i[a].includes("conditionKey"))?(n=[].concat(Object(o.a)(n),Object(o.a)(be(i,e,t)),[N({source:"1",target:"2"})]),a+=2):i[a+1]&&n.push(g(i[a+1],e,{x:250,y:50}),N({source:(Number(e)-1).toString(),target:e})),a++;ne(n)},handleSave:function(){var e=Object.assign([],te),t={eventKey:"",conditions:[]};if(e.filter((function(e){return"btnSelectorNode"===e.type&&!e.data.item})).length)Object(W.a)({title:"Warning",subtitle:"Please complete the flow first before saving",btnLabel:"OK"});else{for(var n=0,i=function(){var i,a,c,o,l=e[n].id;if("event"===(null===(i=e[n].data)||void 0===i?void 0:i.type)){var r,d;t.eventKey=null===(r=e[n].data)||void 0===r||null===(d=r.item)||void 0===d?void 0:d.eventKey,e.splice(n,1)}else{if("condition"===(null===(a=e[n].data)||void 0===a?void 0:a.type))return t.conditions.push(ue(e,l)),"break";if(1===e.filter((function(e){return"btnSelectorNode"===e.type})).length&&"action"===(null===(c=e[n].data)||void 0===c?void 0:c.type)){var s;t.conditions.push({"Fn::If":[[{noCondition:!0}],(null===(s=e[n].data)||void 0===s?void 0:s.item)||[],[]]}),e=e.filter((function(e){return e.id!==l&&e.target!==l}))}else{if("choice"===(null===(o=e[n].data)||void 0===o?void 0:o.type))return{v:void 0};n++}}};e.length>0;){var a=i();if("break"===a)break;if("object"===typeof a)return a.v}console.log("output",t)}},children:Object(f.jsx)(s.a,{variant:"h3",children:"Map your automation"})}),Object(f.jsx)("div",{className:"flow-body",children:Object(f.jsx)(d.c,{elementsSelectable:!0,elements:te,onElementsRemove:function(e){return ne((function(t){return Object(d.d)(e,t)}))},onConnect:function(e){return ne((function(t){return Object(d.b)(e,t)}))},nodeTypes:V,onSelectionChange:function(e){e||P(null)}})})]})]})}}}]);
//# sourceMappingURL=4.56c1f1e9.chunk.js.map