(this["webpackJsonpflow-frontend"]=this["webpackJsonpflow-frontend"]||[]).push([[4],{175:function(e,t,n){},177:function(e,t,n){},178:function(e,t,n){},181:function(e,t,n){},182:function(e,t,n){},184:function(e,t,n){},199:function(e,t,n){"use strict";n.r(t);var i=n(32),a=n(31),o=n(57),c=n(166),l=n(0),r=n.n(l),d=n(167),u=n(145),s=n(147),b=n(176),v=n.n(b),j=n(146),f=(n(175),n(7)),p=function(e){var t=e.handleSave,n=e.hasPreviewButton,i=e.handlePreview,c=e.children,l=Object(o.a)(e,["handleSave","hasPreviewButton","handlePreview","children"]);return Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"CardHeader"},l),{},{children:[Object(f.jsxs)("div",{className:"left-section",children:[c,Object(f.jsx)(j.a,{disableRipple:!0,children:Object(f.jsx)(v.a,{})})]}),Object(f.jsxs)("div",{className:"d-flex",children:[n&&Object(f.jsx)(s.a,{variant:"text",className:"btn-preview",onClick:i,children:"View Preset Flow"}),t&&Object(f.jsx)(s.a,{variant:"contained",onClick:t,children:"Save"})]})]}))},O=n(154),y=n.n(O),h=n(163),m=n.n(h),g=n(164),x=n.n(g),N=[{eventKey:"NewOrder",eventDisplay:"New order placed",fields:[{conditionKey:"ProductTitle",conditionDisplay:"Product Title",type:"string"},{conditionKey:"ProductAmount",conditionDisplay:"Product Amount",type:"int"}]},{eventKey:"NewSignup",eventDisplay:"New signup",fields:[{conditionKey:"Gender",conditionDisplay:"Customer Gender",type:"option",options:["Male","Female"]},{conditionKey:"DOB",conditionDisplay:"Birthday",type:"date"}]}],S=[{actionKey:"SendEmail",actionDisplay:"Send email to contact",fields:[{key:"emailAddress",placeHolder:"Email Address",type:"string"}]},{actionKey:"CallContact",actionDisplay:"Call contact",fields:[{key:"callContact",placeHolder:"Contact Number",type:"string"},{key:"callContactCountry",placeHolder:"Country",type:"selection",option:["Singapore","Malaysia"]}]}],K=[{name:"Equal",value:"=",type:"string"},{name:"Not equal",value:"!=",type:"string"},{name:"Contains",value:"contains",type:"string"},{name:"Not contains",value:"not contains",type:"string"},{name:"Greater than",value:">",type:"int"},{name:"Less than",value:"<",type:"int"},{name:"Greater and equal than",value:">=",type:"int"},{name:"Less and equal than",value:"<=",type:"int"},{name:"Equal",value:"=",type:"date"},{name:"Earlier than",value:"earlier than",type:"date"},{name:"Later than",value:"later than",type:"date"}],C="NewOrder",k=[{"Fn::If":[[{"Fn::And":[{conditionKey:"ProductTitle",value:["coke","pepsi"],operator:"contains"},{conditionKey:"ProductAmount",value:["30"],operator:">="}]}],[{"Fn::If":[[{conditionKey:"ProductTitle",value:["coke"],operator:"="}],[{actionKey:"CallContact",actionInputs:[{key:"callContact",value:"999"},{key:"callContactCountry",value:"Singapore"}]}],[{actionKey:"SendEmail",actionInputs:[{key:"emailAddress",value:"simon@gmail.com"}]}]]}],[{actionKey:"CallContact",actionInputs:[{key:"callContact",value:"0123456789"},{key:"callContactCountry",value:"Malaysia"}]},{actionKey:"SendEmail",actionInputs:[{key:"emailAddress",value:"hello@gmail.com"}]}]]}],A=(n(177),function(e){var t=e.handleSelect,n=e.selectedEventKey,c=Object(o.a)(e,["handleSelect","selectedEventKey"]),r=Object(l.useState)(!1),d=Object(i.a)(r,2),b=d[0],v=d[1];return Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"Events"},c),{},{children:[Object(f.jsx)(p,{children:Object(f.jsx)(u.a,{variant:"h3",children:"Events"})}),Object(f.jsx)("div",Object(a.a)(Object(a.a)({className:"content-body ".concat(N.length>3?"has-show-more":""," ").concat(b?"show-all":"")},c),{},{children:N.map((function(e){return Object(f.jsx)(s.a,{onClick:function(){return t(e)},disableRipple:!0,variant:"text",className:"btn-card-item ".concat(n===e.eventKey?"on-focus":""),startIcon:Object(f.jsx)(y.a,{}),children:e.eventDisplay},e.eventKey)}))})),N.length>3&&Object(f.jsx)("div",{className:"btn-show-more",children:Object(f.jsxs)(s.a,{onClick:function(){return v(!b)},variant:"text",disableRipple:!0,endIcon:b?Object(f.jsx)(m.a,{}):Object(f.jsx)(x.a,{}),children:["Show ",b?"less":"more"]})})]}))}),w=n(63),P=n(196),I=n(201),F=n(202),R=n(193),B=n(197),E=n(198),D=n(180),L=n.n(D),W=n(58),H=(n(178),function(e){var t=e.selectedEventKey,n=e.selectedConditionObj,d=e.handleSelect,b=Object(o.a)(e,["selectedEventKey","selectedConditionObj","handleSelect"]);Object(l.useEffect)((function(){var e,t;k((null===(e=Object.keys(n)[0])||void 0===e?void 0:e.includes("Fn::"))?Object.values(n)[0]:[{conditionKey:n.conditionKey||"",value:n.value||[],operator:n.operator||""}]),g((null===(t=Object.keys(n)[0])||void 0===t?void 0:t.includes("Fn::"))?Object.keys(n)[0]:"")}),[n]);var v={conditionKey:"",value:[],operator:""},j=N.find((function(e){return e.eventKey===t})).fields,O=Object(l.useState)(""),h=Object(i.a)(O,2),m=h[0],g=h[1],x=Object(l.useState)([{conditionKey:"",value:[],operator:""}]),S=Object(i.a)(x,2),C=S[0],k=S[1],A=function(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((function(e,n){return e===t[n]}))},D=function(e,t,n){var i=Object.assign([],C);"value"===n?i[t].value=e.split(","):i[t][n]=e,k(i)};return Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"Conditions"},b),{},{children:[Object(f.jsx)(p,{children:Object(f.jsx)(u.a,{variant:"h3",children:"Conditions"})}),Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"content-body"},b),{},{children:[C.length>1&&Object(f.jsxs)(R.a,{className:"mb-1-5",children:[Object(f.jsx)(I.a,{id:"label-must-meet",children:"All conditions must meet"}),Object(f.jsxs)(E.a,{labelId:"label-must-meet",id:"must-meet",value:m,onChange:function(e){return g(e.target.value)},children:[Object(f.jsx)(F.a,{value:"Fn::And",children:"AND"}),Object(f.jsx)(F.a,{value:"Fn::Or",children:"OR"})]})]}),C.map((function(e,t){var n,i;return Object(f.jsxs)(r.a.Fragment,{children:[0!==t&&Object(f.jsx)(s.a,{className:"btn-clear",variant:"text",startIcon:Object(f.jsx)(L.a,{}),disableRipple:!0,onClick:function(){return function(e){2===C.length&&g("");var t=Object.assign([],C);t.splice(e,1),k(t)}(t)},children:"Remove"}),Object(f.jsxs)(R.a,{children:[Object(f.jsxs)(I.a,{id:"label-condition-".concat(t),children:["Condition ",t+1]}),Object(f.jsx)(E.a,{labelId:"label-condition-".concat(t),id:"condition-".concat(t),value:e.conditionKey||"",onChange:function(e){return D(e.target.value,t,"conditionKey")},children:j.map((function(e){return Object(f.jsx)(F.a,{value:e.conditionKey,children:e.conditionDisplay},e.conditionKey)}))})]}),Object(f.jsxs)(R.a,{children:[Object(f.jsxs)(I.a,{id:"label-operator-".concat(t),children:["Operator ",t+1]}),Object(f.jsx)(E.a,{labelId:"label-operator-".concat(t),id:"operator-".concat(t),value:e.operator||"",onChange:function(e){return D(e.target.value,t,"operator")},children:"option"===(null===(n=j.find((function(t){return t.conditionKey===e.conditionKey})))||void 0===n?void 0:n.type)?j.find((function(t){return t.conditionKey===e.conditionKey})).options.map((function(e){return Object(f.jsx)(F.a,{value:e,children:e},e)})):null===(i=K.filter((function(t){var n;return t.type===(null===(n=j.find((function(t){return t.conditionKey===e.conditionKey})))||void 0===n?void 0:n.type)})))||void 0===i?void 0:i.map((function(e){return Object(f.jsx)(F.a,{value:e.value,children:e.name},e.value)}))})]}),Object(f.jsxs)(R.a,{children:[Object(f.jsx)(P.a,{fullWidth:!0,margin:"dense",onChange:function(e){return D(e.target.value,t,"value")},type:"text",value:e.value.join(",")||"",label:"Value ".concat(t+1)}),Object(f.jsx)(B.a,{children:"Please separate multiple values by comma"})]}),C.length-1!==t&&Object(f.jsx)(u.a,{variant:"h6",className:"must-meet-separator",children:"Fn::And"===m?"AND":"OR"})]},t)})),Object(f.jsx)(s.a,{variant:"text",startIcon:Object(f.jsx)(y.a,{}),disableRipple:!0,className:"btn-add",onClick:function(){m||g("Fn::And"),k([].concat(Object(c.a)(C),[v]))},children:"Add Condition"}),Object(f.jsx)(s.a,{variant:"contained",disableRipple:!0,onClick:function(){var e,t,n,i,a,o,c,l,r,u,s,b;if(C.find((function(e){return!e.conditionKey||!e.operator||e.value.filter((function(e){return!e})).length})))Object(W.a)({title:"Warning",subtitle:"Please complete the condition fields before saving",btnLabel:"OK"});else if(C.length>1&&((null===(e=C.find((function(e){return">"===e.operator})))||void 0===e?void 0:e.value[0])>(null===(t=C.find((function(e){return"<"===e.operator||"<="===e.operator})))||void 0===t?void 0:t.value[0])||(null===(n=C.find((function(e){return">="===e.operator})))||void 0===n?void 0:n.value[0])>=(null===(i=C.find((function(e){return"<="===e.operator||"<"===e.operator})))||void 0===i?void 0:i.value[0])||(null===(a=C.find((function(e){return"later than"===e.operator})))||void 0===a?void 0:a.value)&&(null===(o=C.find((function(e){return"earlier than"===e.operator})))||void 0===o?void 0:o.value)&&(null===(c=C.find((function(e){return"later than"===e.operator})))||void 0===c?void 0:c.value[0])>(null===(l=C.find((function(e){return"earlier than"===e.operator})))||void 0===l?void 0:l.value[0])||(null===(r=C.find((function(e){return"="===e.operator})))||void 0===r?void 0:r.value)&&(null===(u=C.find((function(e){return"!="===e.operator})))||void 0===u?void 0:u.value)&&A(C.find((function(e){return"="===e.operator})).value,C.find((function(e){return"!="===e.operator})).value)||(null===(s=C.find((function(e){return"contains"===e.operator})))||void 0===s?void 0:s.value)&&(null===(b=C.find((function(e){return"not contains"===e.operator})))||void 0===b?void 0:b.value)&&A(C.find((function(e){return"contains"===e.operator})).value,C.find((function(e){return"not contains"===e.operator})).value)))Object(W.a)({title:"Warning",subtitle:"Conditions have contradiction. Please try again.",btnLabel:"OK"});else{for(var v=Object.assign([],C),j=function(){var e=v[0],t=v.filter((function(t){return t.conditionKey===e.conditionKey}));v=v.filter((function(e){return t.includes(e.conditionKey)}))};v.length>0;)j();console.log(C);var f=m?Object(w.a)({},m,C):C[0];d(f)}},children:"Save Condition"})]}))]}))}),T=(n(181),function(e){var t=e.handleSelect,n=(e.handleAddAction,e.actionsArr),c=e.selectedActionObj,r=Object(o.a)(e,["handleSelect","handleAddAction","actionsArr","selectedActionObj"]),d=Object(l.useState)({}),b=Object(i.a)(d,2),v=b[0],j=b[1];Object(l.useEffect)((function(){Object.keys(c).length?K(O(c)):(K({}),j({}))}),[c]);var O=function(e){return j(e.actionInputs.reduce((function(e,t){return e[t.key]=t.value,e}),{})),S.find((function(t){return t.actionKey===e.actionKey}))},h=Object(l.useState)({}),g=Object(i.a)(h,2),N=g[0],K=g[1],C=Object(l.useState)(!1),k=Object(i.a)(C,2),A=k[0],w=k[1],B=function(e,t){if("callContact"!==t.key||/^[0-9]*$/.test(e.target.value)){var n=Object.assign({},v);n[t.key]=e.target.value,j(n)}};return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"Actions"},r),{},{children:[Object(f.jsx)(p,{children:Object(f.jsx)(u.a,{variant:"h3",children:"Actions"})}),Object(f.jsxs)("div",Object(a.a)(Object(a.a)({className:"content-body ".concat(S.length>3?"has-show-more":""," ").concat(A?"show-all":"")},r),{},{children:[S.filter((function(e){return!n.map((function(e){return e.actionKey})).includes(e.actionKey)})).map((function(e){return Object(f.jsx)(s.a,{onClick:function(){K(e)},disableRipple:!0,variant:"text",className:"btn-card-item ".concat((null===N||void 0===N?void 0:N.actionKey)===e.actionKey?"on-focus":""),startIcon:Object(f.jsx)(y.a,{}),children:e.actionDisplay},e.actionKey)})),!S.filter((function(e){return!n.map((function(e){return e.actionKey})).includes(e.actionKey)})).length&&Object(f.jsx)(u.a,{variant:"body1",className:"label-no-more",children:"No action available"})]})),S.length>3&&Object(f.jsx)("div",{className:"btn-show-more",children:Object(f.jsxs)(s.a,{onClick:function(){return w(!A)},variant:"text",disableRipple:!0,endIcon:A?Object(f.jsx)(m.a,{}):Object(f.jsx)(x.a,{}),children:["Show ",A?"less":"more"]})})]})),Object.keys(N).length>0&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(p,{children:Object(f.jsx)(u.a,{variant:"h3",children:"Action Details"})}),Object(f.jsxs)("div",{className:"card-body",children:[N.fields.map((function(e){return"selection"===e.type?Object(f.jsxs)(R.a,{children:[Object(f.jsx)(I.a,{id:"label-".concat(e.key),children:e.placeHolder}),Object(f.jsx)(E.a,{labelId:"label-".concat(e.key),id:e.key,value:v[e.key]||"",onChange:function(t){return B(t,e)},children:e.option.map((function(e){return Object(f.jsx)(F.a,{value:e,children:e},e)}))})]},e.key):Object(f.jsx)(P.a,{fullWidth:!0,margin:"dense",onChange:function(t){return B(t,e)},type:"text",value:v[e.key]||"",label:e.placeHolder,placeholder:e.placeHolder},e.key)})),Object(f.jsx)(s.a,{variant:"contained",className:"mt-1",disableRipple:!0,onClick:function(){if(N.fields.length!==Object.keys(v).length||Object.values(v).filter((function(e){return!e})).length)Object(W.a)({title:"Warning",subtitle:"Please complete the action fields before saving",btnLabel:"OK"});else{var e={actionKey:N.actionKey,actionInputs:Object.entries(v).map((function(e){return{key:e[0],value:e[1]}}))};t(e,Object.keys(c).length?"update":"add")}},children:Object.keys(c).length?"Update":"Add"})]})]})]})}),q=n(66),G=n(183),M=n.n(G),J=(n(182),Object(l.memo)((function(e){var t,n,i,a=e.id,o=e.data,c=e.isConnectable,l=Object(d.e)((function(e){return e.selectedElements}));return Object(f.jsxs)("div",{className:"ButtonSelectorNode ".concat(l&&l[0].id===a?"is-selected":""),onClick:function(){return o.focusNodeAction(a)},children:[Object(f.jsx)(u.a,{variant:"body1",className:"node-label",children:o.label}),"event"===o.type&&(o.item?Object(f.jsx)(s.a,{variant:"text",disabled:!0,className:"lbl-event",children:null===(t=o.item)||void 0===t?void 0:t.eventDisplay}):o.btnLabel&&Object(f.jsx)(s.a,{onClick:function(e){o.btnAction(a),e.stopPropagation()},variant:"text",children:o.btnLabel})),("condition"===o.type||"choice"===o.type)&&Object(f.jsxs)(f.Fragment,{children:["condition"===o.type&&Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(j.a,{disableRipple:!0,className:"btn-delete",onClick:function(e){o.handleRemoveNode(a,"condition"),e.stopPropagation()},children:Object(f.jsx)(M.a,{})})}),o.item?Object(f.jsx)(s.a,{variant:"text",disabled:!0,className:"lbl-condition",children:Object.keys(o.item)[0].includes("Fn::")?Object.values(o.item)[0].map((function(e){return"".concat(e.conditionKey," ").concat(e.operator," ").concat(e.value.join(", "))})).join(" ".concat(Object.keys(o.item)[0].replace("Fn::","")," ")):"".concat(o.item.conditionKey," ").concat(o.item.operator," ").concat(o.item.value.join(", "))}):o.btnLabel&&Object(f.jsx)(s.a,{onClick:function(e){o.btnAction(a),e.stopPropagation()},variant:"text",children:o.btnLabel})]}),"action"===o.type&&"2"===a&&!(null===(n=o.item)||void 0===n?void 0:n.length)&&Object(f.jsx)(j.a,{disableRipple:!0,className:"btn-delete",onClick:function(e){o.handleRemoveNode(a,"condition"),e.stopPropagation()},children:Object(f.jsx)(M.a,{})}),"action"===o.type&&((null===(i=o.item)||void 0===i?void 0:i.length)?Object(f.jsxs)(f.Fragment,{children:[o.item.map((function(e,t){return Object(f.jsx)(r.a.Fragment,{children:Object(f.jsxs)("div",{className:"label-div",children:[Object(f.jsx)(s.a,{variant:"text",onClick:function(e){o.handleSelectAction(a,t),e.stopPropagation()},className:"lbl-action",children:"Action: ".concat(e.actionKey,"\n                    ").concat(e.actionInputs.map((function(e){return"".concat(e.key," - ").concat(e.value)})).join(", "))}),Object(f.jsx)(j.a,{disableRipple:!0,onClick:function(n){o.handleDeleteAction(a,t,e.actionKey),n.stopPropagation()},children:Object(f.jsx)(M.a,{})}),t!==o.item.length-1&&Object(f.jsx)(u.a,{variant:"h6",children:"AND"})]})},t)})),Object(f.jsx)(s.a,{onClick:function(e){o.btnAction(a),e.stopPropagation()},variant:"text",children:"Add Action"})]}):o.btnLabel&&Object(f.jsx)(s.a,{onClick:function(e){o.btnAction(a),e.stopPropagation()},variant:"text",children:o.btnLabel})),"choice"===o.type&&Object(f.jsx)(u.a,{variant:"h6",className:"text-or",children:"OR"}),o.btnLabel2&&Object(f.jsx)(s.a,{onClick:function(e){o.btnAction2(a),e.stopPropagation()},variant:"text",children:o.btnLabel2}),Object(f.jsx)(d.a,{type:"source",position:"bottom",style:{bottom:10,top:"auto",background:"transparent"},isConnectable:c})]})}))),V=(n(184),{btnSelectorNode:J}),U=0;t.default=function(){var e,t,n,r,s,b,v,j,O,y;Object(l.useEffect)((function(){window.innerWidth<768&&Object(W.a)({title:"Warning",subtitle:"Device must be larger than 768px x 1024px to support flow",persistent:!0})}),[]);var h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:250,y:50};return{id:t.toString(),position:n,type:"btnSelectorNode",data:{item:e,type:"event",label:"When...",btnLabel:"Select Event Trigger",focusNodeAction:function(e){I("events"),E(e)},btnAction:function(e){I("events"),E(e)}}}},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:250,y:50};return{id:t.toString(),position:n,type:"btnSelectorNode",data:{item:e,type:"condition",label:"If...",btnLabel:"Add condition",focusNodeAction:function(e){I("conditions"),E(e)},handleSwapConditionArrows:function(e){return te(e)},handleRemoveNode:function(e,t){return ee(e,t)},btnAction:function(e){I("conditions"),E(e)}}}},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:250,y:50};return{id:t.toString(),position:n,type:"btnSelectorNode",data:{item:e,type:"action",label:"Then...",btnLabel:"Add action",focusNodeAction:function(e){I(null),M(null),E(e)},btnAction:function(e){I("actions"),M(null),E(e)},handleSelectAction:function(e,t){I("actions"),E(e),Z(t)},handleDeleteAction:function(e,t,n){E(e),_(e,t)},handleRemoveNode:function(e,t){return ee(e,t)}}}},x=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:250,y:50};return{id:t.toString(),position:n,type:"btnSelectorNode",data:{type:"choice",label:"Next Step",btnLabel:"Add condition",btnLabel2:"Add action",focusNodeAction:function(e){I(null),E(e)},btnAction:function(i){var a;I("conditions"),U+=1,E(i);var o=Object.assign([],X.current);(a=o=o.filter((function(e){return e.id!==t&&e.id!=="edges-".concat((Number(t)-1).toString(),"-").concat(t)}))).push.apply(a,[m(null,t,n),g(null,Number(t)+1,{x:n.x-250,y:n.y+150}),U+1>3?g(null,Number(t)+2,{x:n.x+300,y:n.y+150}):e((Number(t)+2).toString(),{x:n.x+300,y:n.y+150})].concat(Object(c.a)("2"===t?[S({source:(Number(t)-1).toString(),target:t})]:[]),[S({source:t,target:(Number(t)+1).toString(),label:"yes",labelBgPadding:[8,4],labelBgBorderRadius:13,labelStyle:{fill:"#3b8dd6",fontWeight:700},labelBgStyle:{fill:"#f1f7fb"}}),S({source:t,target:(Number(t)+2).toString(),label:"no",labelBgPadding:[8,4],labelBgBorderRadius:13,labelStyle:{fill:"#4a5568",fontWeight:700},labelBgStyle:{fill:"#ececec"}})])),Q(o)},btnAction2:function(e){var i;I("actions"),E(e);var a=Object.assign([],X.current);(i=a=a.filter((function(e){return e.id!==t&&e.id!=="edges-".concat((Number(t)-1).toString(),"-").concat(t)}))).push.apply(i,[g(null,t,n)].concat(Object(c.a)("2"===t?[S({source:(Number(t)-1).toString(),target:t})]:[]))),Q(a)}}}},S=function(e){var t=e.source,n=e.target,i=Object(o.a)(e,["source","target"]);return Object(a.a)({id:"edges-".concat(t,"-").concat(n),source:t.toString(),target:n.toString(),type:"default"},i)},K=Object(l.useState)("events"),w=Object(i.a)(K,2),P=w[0],I=w[1],F=Object(l.useState)("1"),R=Object(i.a)(F,2),B=R[0],E=R[1],D=Object(l.useState)(null),L=Object(i.a)(D,2),G=L[0],M=L[1],J=Object(l.useState)([h()]),$=Object(i.a)(J,2),z=$[0],Q=$[1],X=Object(l.useRef)();X.current=z;var Y=Object(l.useRef)();Y.current=B;var Z=function(e){M(e)},_=function(e,t){var n,i,o,c=Object.assign([],X.current),l=c.findIndex((function(t){return t.id===e}));c[l]=Object(a.a)(Object(a.a)({},c[l]),{},{data:Object(a.a)(Object(a.a)({},null===(n=c[l])||void 0===n?void 0:n.data),{},{item:((null===(i=c[l])||void 0===i||null===(o=i.data)||void 0===o?void 0:o.item)||[]).filter((function(e,n){return n!==t}))})}),Q(c),I(null)},ee=function(e,t){var n=Object.assign([],X.current),i=n.find((function(t){return t.id===e}));"condition"===t&&(U=n.filter((function(t){return"btnSelectorNode"===t.type&&"condition"===t.data.type&&t.id<e})).length),Q([].concat(Object(c.a)(n.filter((function(t){return"btnSelectorNode"!==t.type&&!new RegExp(n.filter((function(t){return"btnSelectorNode"===t.type&&t.id>e})).map((function(e){return e.id})).join("|")||"0").test(t.id)}))),Object(c.a)(n.filter((function(t){return t.id<e}))),[x(e,i.position)])),I(null)},te=function(e){var t=Object.assign([],X.current),n=t.findIndex((function(t){return t.source===e&&"yes"===t.label})),i=t.findIndex((function(t){return t.source===e&&"no"===t.label}));t[n].label="yes"===t[n].label?"no":"yes",t[i].label="yes"===t[i].label?"no":"yes",Q(t)},ne=function e(t,n){var i,a,o,c,l,r={"Fn::If":[(null===(i=t.find((function(e){return e.id===n})).data)||void 0===i?void 0:i.item)?[null===(a=t.find((function(e){return e.id===n})).data)||void 0===a?void 0:a.item]:[]]},d=(t=t.filter((function(e){return e.target!==n&&e.id!==n}))).find((function(e){return e.source===n&&"yes"===e.label})).target;"condition"===(null===(o=t.find((function(e){return e.id===d})).data)||void 0===o?void 0:o.type)?r["Fn::If"].push([e(t,n)]):r["Fn::If"].push((null===(l=t.find((function(e){return e.id===d})).data)||void 0===l?void 0:l.item)||[]);var u,s=(t=t.filter((function(e){return e.target!==d&&e.id!==d}))).find((function(e){return e.source===n&&"no"===e.label})).target;"condition"===(null===(c=t.find((function(e){return e.id===s})).data)||void 0===c?void 0:c.type)?r["Fn::If"].push([e(t,s)]):r["Fn::If"].push((null===(u=t.find((function(e){return e.id===s})).data)||void 0===u?void 0:u.item)||[]);return t=t.filter((function(e){return e.target!==s&&e.id!==s})),r},ie=function e(t,n,i){return[m(Object.values(t[0])[0],n,i),g(t[2],n+1,{x:i.x-250,y:i.y+150})].concat(Object(c.a)(Object.keys(t[1][0])[0].includes("Fn::")?e(Object.values(t[1][0])[0],n+2,{x:i.x+300,y:i.y+150}):[g(t[1],n+2,{x:i.x+300,y:i.y+150})]),[S({source:n,target:Number(n)+1,label:"yes",labelBgPadding:[8,4],labelBgBorderRadius:13,labelStyle:{fill:"#3b8dd6",fontWeight:700},labelBgStyle:{fill:"#f1f7fb"}}),S({source:n,target:Number(n)+2,label:"no",labelBgPadding:[8,4],labelBgBorderRadius:13,labelStyle:{fill:"#4a5568",fontWeight:700},labelBgStyle:{fill:"#ececec"}})])};return Object(f.jsxs)(q.a,{fullHeight:!0,color:"HomePage grey100",children:[P&&Object(f.jsxs)("div",{className:"drawer",children:["events"===P&&Object(f.jsx)(A,{selectedEventKey:null===(e=z.find((function(e){var t;return"event"===(null===(t=e.data)||void 0===t?void 0:t.type)})).data)||void 0===e||null===(t=e.item)||void 0===t?void 0:t.eventKey,handleSelect:function(e){var t=[h(e)];1===t.length&&t.push(x("2",{x:250,y:180}),S({source:"1",target:"2"})),I(null),Q(t)}}),"conditions"===P&&Object(f.jsx)(H,{selectedEventKey:null===(n=z.find((function(e){var t;return"event"===(null===(t=e.data)||void 0===t?void 0:t.type)})).data)||void 0===n||null===(r=n.item)||void 0===r?void 0:r.eventKey,selectedConditionObj:(null===(s=X.current.find((function(e){return e.id===Y.current})))||void 0===s||null===(b=s.data)||void 0===b?void 0:b.item)||{},handleSelect:function(e){var t,n=Object.assign([],X.current),i=n.findIndex((function(e){return e.id===Y.current}));n[i]=Object(a.a)(Object(a.a)({},n[i]),{},{data:Object(a.a)(Object(a.a)({},null===(t=n[i])||void 0===t?void 0:t.data),{},{item:e})}),Q(n)}}),"actions"===P&&Object(f.jsx)(T,{actionsArr:(null===(v=X.current.find((function(e){return e.id===Y.current})))||void 0===v||null===(j=v.data)||void 0===j?void 0:j.item)||[],selectedActionObj:((null===(O=X.current.find((function(e){return e.id===Y.current})))||void 0===O||null===(y=O.data)||void 0===y?void 0:y.item)||[])[G]||{},handleSelect:function(e,t){var n,i,o,l,r,d,u,s=Object.assign([],X.current),b=s.findIndex((function(e){return e.id===Y.current}));s[b]=Object(a.a)(Object(a.a)({},s[b]),{},{data:Object(a.a)(Object(a.a)({},null===(n=s[b])||void 0===n?void 0:n.data),{},{item:"update"===t?[].concat(Object(c.a)(null===(i=s[b])||void 0===i||null===(o=i.data)||void 0===o?void 0:o.item.slice(0,G)),[e],Object(c.a)(null===(l=s[b])||void 0===l||null===(r=l.data)||void 0===r?void 0:r.item.slice(G+1))):[].concat(Object(c.a)((null===(d=s[b])||void 0===d||null===(u=d.data)||void 0===u?void 0:u.item)||[]),[e])})}),Q(s)}})]}),Object(f.jsxs)("div",{className:"home-section",children:[Object(f.jsx)(p,{hasPreviewButton:!0,handlePreview:function(){var e=1,t={x:250,y:200},n=[],i=Object.assign([],k[0]["Fn::If"]);n.push(h(N.find((function(e){return e.eventKey===C}))));for(var a=0;a<3;)e+=1,Object.keys(i[a]).includes("Fn::")||Object.keys(i[a].includes("conditionKey"))?(n=[].concat(Object(c.a)(n),Object(c.a)(ie(i,e,t)),[S({source:"1",target:"2"})]),a+=2):i[a+1]&&n.push(g(i[a+1],e,{x:250,y:50}),S({source:(Number(e)-1).toString(),target:e})),a++;Q(n)},handleSave:function(){var e=Object.assign([],z),t={eventKey:"",conditions:[]};if(e.filter((function(e){return"btnSelectorNode"===e.type&&!e.data.item})).length)Object(W.a)({title:"Warning",subtitle:"Please complete the flow first before saving",btnLabel:"OK"});else{for(var n=0,i=function(){var i,a,o,c,l=e[n].id;if("event"===(null===(i=e[n].data)||void 0===i?void 0:i.type)){var r,d;t.eventKey=null===(r=e[n].data)||void 0===r||null===(d=r.item)||void 0===d?void 0:d.eventKey,e.splice(n,1)}else{if("condition"===(null===(a=e[n].data)||void 0===a?void 0:a.type))return t.conditions.push(ne(e,l)),"break";if(1===e.filter((function(e){return"btnSelectorNode"===e.type})).length&&"action"===(null===(o=e[n].data)||void 0===o?void 0:o.type)){var u;t.conditions.push({"Fn::If":[[{noCondition:!0}],(null===(u=e[n].data)||void 0===u?void 0:u.item)||[],[]]}),e=e.filter((function(e){return e.id!==l&&e.target!==l}))}else{if("choice"===(null===(c=e[n].data)||void 0===c?void 0:c.type))return{v:void 0};n++}}};e.length>0;){var a=i();if("break"===a)break;if("object"===typeof a)return a.v}console.log("output",t)}},children:Object(f.jsx)(u.a,{variant:"h3",children:"Map your automation"})}),Object(f.jsx)("div",{className:"flow-body",children:Object(f.jsx)(d.c,{elementsSelectable:!0,elements:z,onElementsRemove:function(e){return Q((function(t){return Object(d.d)(e,t)}))},onConnect:function(e){return Q((function(t){return Object(d.b)(e,t)}))},nodeTypes:V,onSelectionChange:function(e){e||I(null)}})})]})]})}}}]);
//# sourceMappingURL=4.dd78386d.chunk.js.map